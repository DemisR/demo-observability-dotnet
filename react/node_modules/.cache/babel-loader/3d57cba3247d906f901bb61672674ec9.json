{"ast":null,"code":"import _classCallCheck from\"/Users/deri/Documents/Github/demo-observability-dotnet/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/deri/Documents/Github/demo-observability-dotnet/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/deri/Documents/Github/demo-observability-dotnet/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/deri/Documents/Github/demo-observability-dotnet/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/deri/Documents/Github/demo-observability-dotnet/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/*global Sentry*/import React,{Component}from\"react\";import{connect}from'react-redux';import\"./App.css\";import wrenchImg from\"../assets/wrench.png\";import nailsImg from\"../assets/nails.png\";import hammerImg from\"../assets/hammer.png\";import*as actions from'../store/actions/index';var PORT=process.env.REACT_APP_PORT||3001;// make deploy_gcp\n// const BACKEND = process.env.REACT_APP_BACKEND || `http://localhost:${PORT}`;\n// npm run deploy\nvar BACKEND=\"http://localhost:5000\";var WORKFLOW=process.env.REACT_APP_WORKFLOW!==\"false\";var request=require('request');var monify=function monify(n){return(n/100).toFixed(2);};var getUniqueId=function getUniqueId(){return'_'+Math.random().toString(36).substr(2,9);};var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.state={success:false,hasError:false};// generate random email\n_this.email=Math.random().toString(36).substring(2,6)+\"@yahoo.com\";_this.store=[{id:\"wrench\",name:\"Wrench\",price:500,img:wrenchImg},{id:\"nails\",name:\"Nails\",price:25,img:nailsImg},{id:\"hammer\",name:\"Hammer\",price:1000,img:hammerImg}];_this.checkout=_this.checkout.bind(_assertThisInitialized(_this));// generate unique sessionId and set as Sentry tag\n_this.sessionId=getUniqueId();Sentry.configureScope(function(scope){scope.setTag(\"session_id\",_this.sessionId);});return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var defaultError=window.onerror;window.onerror=function(error){_this2.setState({hasError:true,success:false});defaultError(error);};// Add context to error/event\nSentry.configureScope(function(scope){scope.setUser({email:_this2.email});// attach user/email context\nscope.setTag(\"customerType\",_this2.getPlanName());// custom-tag\n});//Will add an XHR Sentry breadcrumb\nthis.performXHRRequest();}},{key:\"getPlanName\",value:function getPlanName(){var plans=[\"medium-plan\",\"large-plan\",\"small-plan\",\"enterprise\"];return plans[Math.floor(Math.random()*plans.length)];}},{key:\"performXHRRequest\",value:function performXHRRequest(){fetch('https://jsonplaceholder.typicode.com/todos/1').then(function(response){return response.json();}).then(function(json){return console.log(json);});}},{key:\"checkout\",value:function checkout(){var _this3=this;Sentry.addBreadcrumb({category:'cart',message:'User clicked on Checkout',level:'info'});if(WORKFLOW){this.myCodeIsPerfect();}/*\n      POST request to /checkout endpoint.\n        - Custom header with transactionId for transaction tracing\n        - throw error if response !== 200\n    */var order={email:this.email,cart:this.props.cart};// generate unique transactionId and set as Sentry tag\nvar transactionId=getUniqueId();Sentry.configureScope(function(scope){scope.setTag(\"transaction_id\",transactionId);});// perform request (set transctionID as header and throw error appropriately)\nrequest.post({// url: `${BACKEND}/checkout`, My change\nurl:\"\".concat(BACKEND,\"/api/values\"),json:order,headers:{\"X-Session-ID\":this.sessionId,\"X-Transaction-ID\":transactionId}},function(error,response){if(error){throw error;}if(response.statusCode===200){_this3.setState({success:true});}else{throw new Error(response.statusCode+\" - \"+(response.statusMessage||response.body));}});}},{key:\"render\",value:function render(){var _this4=this;var total=this.props.cart.reduce(function(t,i){return t+i.price;},0);var cartDisplay=this.props.cart.reduce(function(c,_ref){var id=_ref.id;c[id]=c[id]?c[id]+1:1;return c;},{});return/*#__PURE__*/React.createElement(\"div\",{className:\"App\"},/*#__PURE__*/React.createElement(\"main\",null,/*#__PURE__*/React.createElement(\"header\",null,/*#__PURE__*/React.createElement(\"h1\",null,\"Online Hardware Store\")),/*#__PURE__*/React.createElement(\"div\",{className:\"inventory\"},this.store.map(function(item){var name=item.name,id=item.id,img=item.img,price=item.price;return/*#__PURE__*/React.createElement(\"div\",{className:\"item\",key:id},/*#__PURE__*/React.createElement(\"div\",{className:\"thumbnail\"},/*#__PURE__*/React.createElement(\"img\",{src:img,alt:\"\"})),/*#__PURE__*/React.createElement(\"p\",null,name),/*#__PURE__*/React.createElement(\"div\",{className:\"button-wrapper\"},/*#__PURE__*/React.createElement(\"strong\",null,\"$\",monify(price)),/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return _this4.props.onBuyItem(item);}},\"Buy!\")));}))),/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar\"},/*#__PURE__*/React.createElement(\"header\",null,/*#__PURE__*/React.createElement(\"h4\",null,\"Hi, \",this.email,\"!\")),/*#__PURE__*/React.createElement(\"div\",{className:\"cart\"},this.props.cart.length?/*#__PURE__*/React.createElement(\"div\",null,Object.keys(cartDisplay).map(function(id){var _this4$store$find=_this4.store.find(function(i){return i.id===id;}),name=_this4$store$find.name,price=_this4$store$find.price;var qty=cartDisplay[id];return/*#__PURE__*/React.createElement(\"div\",{className:\"cart-item\",key:id},/*#__PURE__*/React.createElement(\"div\",{className:\"cart-item-name\"},name,\" x\",qty),/*#__PURE__*/React.createElement(\"div\",{className:\"cart-item-price\"},\"$\",monify(price*qty)));}),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(\"div\",{className:\"cart-item\"},/*#__PURE__*/React.createElement(\"div\",{className:\"cart-item-name\"},/*#__PURE__*/React.createElement(\"strong\",null,\"Total\")),/*#__PURE__*/React.createElement(\"div\",{className:\"cart-item-price\"},/*#__PURE__*/React.createElement(\"strong\",null,\"$\",monify(total))))):\"Your cart is empty\"),this.state.hasError&&/*#__PURE__*/React.createElement(\"p\",{className:\"cart-error\"},\"Something went wrong\"),this.state.success&&/*#__PURE__*/React.createElement(\"p\",{className:\"cart-success\"},\"Thank you for your purchase!\"),/*#__PURE__*/React.createElement(\"button\",{onClick:this.checkout,disabled:this.props.cart.length===0},\"Checkout\"),\" \",this.props.cart.length>0&&/*#__PURE__*/React.createElement(\"button\",{onClick:this.props.onResetCart,className:\"cart-reset\"},\"Empty cart\")));}}]);return App;}(Component);var mapStateToProps=function mapStateToProps(state){return{cart:state.cart};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{onBuyItem:function onBuyItem(item){return dispatch(actions.buyItem(item));},onResetCart:function onResetCart(){return dispatch(actions.resetCart());}};};export default connect(mapStateToProps,mapDispatchToProps)(App);","map":{"version":3,"sources":["/Users/deri/Documents/Github/demo-observability-dotnet/react/src/components/App.js"],"names":["React","Component","connect","wrenchImg","nailsImg","hammerImg","actions","PORT","process","env","REACT_APP_PORT","BACKEND","WORKFLOW","REACT_APP_WORKFLOW","request","require","monify","n","toFixed","getUniqueId","Math","random","toString","substr","App","props","state","success","hasError","email","substring","store","id","name","price","img","checkout","bind","sessionId","Sentry","configureScope","scope","setTag","defaultError","window","onerror","error","setState","setUser","getPlanName","performXHRRequest","plans","floor","length","fetch","then","response","json","console","log","addBreadcrumb","category","message","level","myCodeIsPerfect","order","cart","transactionId","post","url","headers","statusCode","Error","statusMessage","body","total","reduce","t","i","cartDisplay","c","map","item","onBuyItem","Object","keys","find","qty","onResetCart","mapStateToProps","mapDispatchToProps","dispatch","buyItem","resetCart"],"mappings":"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","sourcesContent":["/*global Sentry*/\nimport React, { Component } from \"react\";\nimport { connect } from 'react-redux';\n\nimport \"./App.css\";\nimport wrenchImg from \"../assets/wrench.png\";\nimport nailsImg from \"../assets/nails.png\";\nimport hammerImg from \"../assets/hammer.png\";\nimport * as actions from '../store/actions/index';\n\nconst PORT = process.env.REACT_APP_PORT || 3001;\n// make deploy_gcp\n// const BACKEND = process.env.REACT_APP_BACKEND || `http://localhost:${PORT}`;\n// npm run deploy\nconst BACKEND = `http://localhost:5000`\nconst WORKFLOW = process.env.REACT_APP_WORKFLOW !== \"false\";\n\nconst request = require('request');\n\n\nconst monify = n => (n / 100).toFixed(2);\nconst getUniqueId = () => '_' + Math.random().toString(36).substr(2, 9);\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      success: false,\n      hasError: false\n    };\n\n    // generate random email\n    this.email =\n      Math.random()\n        .toString(36)\n        .substring(2, 6) + \"@yahoo.com\";\n\n    this.store = [\n      {\n        id: \"wrench\",\n        name: \"Wrench\",\n        price: 500,\n        img: wrenchImg\n      },\n      {\n        id: \"nails\",\n        name: \"Nails\",\n        price: 25,\n        img: nailsImg\n      },\n      {\n        id: \"hammer\",\n        name: \"Hammer\",\n        price: 1000,\n        img: hammerImg\n      }\n    ];\n\n    this.checkout = this.checkout.bind(this);\n\n    // generate unique sessionId and set as Sentry tag\n    this.sessionId = getUniqueId();\n    Sentry.configureScope(scope => {\n      scope.setTag(\"session_id\", this.sessionId);\n    });\n  }\n\n  componentDidMount() {\n    const defaultError = window.onerror;\n    window.onerror = error => {\n      this.setState({ hasError: true, success: false });\n      defaultError(error);\n    };\n    // Add context to error/event\n    Sentry.configureScope(scope => {\n      scope.setUser({ email: this.email }); // attach user/email context\n      scope.setTag(\"customerType\", this.getPlanName()); // custom-tag\n    });\n\n    //Will add an XHR Sentry breadcrumb\n    this.performXHRRequest();\n  }\n\n   getPlanName() {\n     const plans = [\"medium-plan\", \"large-plan\", \"small-plan\", \"enterprise\"];\n     return plans[Math.floor(Math.random() * plans.length)];\n   }\n\n  performXHRRequest(){\n    fetch('https://jsonplaceholder.typicode.com/todos/1')\n      .then(response => response.json())\n      .then(json => console.log(json));\n  }\n\n  checkout() {\n    Sentry.addBreadcrumb({\n      category: 'cart',\n      message: 'User clicked on Checkout',\n      level: 'info'\n    });\n\n    if (WORKFLOW) {\n      this.myCodeIsPerfect();\n    }\n\n    /*\n      POST request to /checkout endpoint.\n        - Custom header with transactionId for transaction tracing\n        - throw error if response !== 200\n    */\n    const order = {\n      email: this.email,\n      cart: this.props.cart\n    };\n\n    // generate unique transactionId and set as Sentry tag\n    const transactionId = getUniqueId();\n    Sentry.configureScope(scope => {\n      scope.setTag(\"transaction_id\", transactionId);\n    });\n    // perform request (set transctionID as header and throw error appropriately)\n    request.post({\n        // url: `${BACKEND}/checkout`, My change\n        url: `${BACKEND}/api/values`,\n        json: order,\n        headers: {\n          \"X-Session-ID\": this.sessionId,\n          \"X-Transaction-ID\": transactionId\n\n        }\n      }, (error, response) => {\n        if (error) {\n          throw error;\n        }\n        if (response.statusCode === 200) {\n          this.setState({ success: true });\n        } else {\n          throw new Error(response.statusCode + \" - \" + (response.statusMessage || response.body));\n        }\n      }\n    );\n  }\n\n  render() {\n    const total = this.props.cart.reduce((t, i) => t + i.price, 0);\n    const cartDisplay = this.props.cart.reduce((c, { id }) => {\n      c[id] = c[id] ? c[id] + 1 : 1;\n      return c;\n    }, {});\n\n    return (\n      <div className=\"App\">\n        <main>\n          <header>\n            <h1>Online Hardware Store</h1>\n          </header>\n\n          <div className=\"inventory\">\n            {this.store.map(item => {\n              const { name, id, img, price } = item;\n              return (\n                <div className=\"item\" key={id}>\n                  <div className=\"thumbnail\">\n                    <img src={img} alt=\"\" />\n                  </div>\n                  <p>{name}</p>\n                  <div className=\"button-wrapper\">\n                    <strong>${monify(price)}</strong>\n                    <button onClick={() => this.props.onBuyItem(item)}>Buy!</button>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        </main>\n        <div className=\"sidebar\">\n          <header>\n            <h4>Hi, {this.email}!</h4>\n          </header>\n          <div className=\"cart\">\n            {this.props.cart.length ? (\n              <div>\n                {Object.keys(cartDisplay).map(id => {\n                  const { name, price } = this.store.find(i => i.id === id);\n                  const qty = cartDisplay[id];\n                  return (\n                    <div className=\"cart-item\" key={id}>\n                      <div className=\"cart-item-name\">\n                        {name} x{qty}\n                      </div>\n                      <div className=\"cart-item-price\">\n                        ${monify(price * qty)}\n                      </div>\n                    </div>\n                  );\n                })}\n                <hr />\n                <div className=\"cart-item\">\n                  <div className=\"cart-item-name\">\n                    <strong>Total</strong>\n                  </div>\n                  <div className=\"cart-item-price\">\n                    <strong>${monify(total)}</strong>\n                  </div>\n                </div>\n              </div>\n            ) : (\n              \"Your cart is empty\"\n            )}\n          </div>\n          {this.state.hasError && (\n            <p className=\"cart-error\">Something went wrong</p>\n          )}\n          {this.state.success && (\n            <p className=\"cart-success\">Thank you for your purchase!</p>\n          )}\n          <button\n            onClick={this.checkout}\n            disabled={this.props.cart.length === 0}\n          >\n            Checkout\n          </button>{\" \"}\n          {this.props.cart.length > 0 && (\n            <button onClick={this.props.onResetCart} className=\"cart-reset\">\n              Empty cart\n            </button>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n      cart: state.cart,\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n      onBuyItem: (item) => dispatch(actions.buyItem(item)),\n      onResetCart: () => dispatch(actions.resetCart()),\n  }\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n"]},"metadata":{},"sourceType":"module"}